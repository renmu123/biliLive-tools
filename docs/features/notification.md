# 通知

支持多种通知方式，在录制完成、上传完成、任务失败等事件发生时及时通知你。

::: warning 安全提示
使用通知功能时，请妥善保存所有信息，请勿分享给他人。本软件不会发送任何信息到任何服务器。
:::

## 支持的通知方式

- 邮箱（SMTP）
- Server酱
- Telegram Bot
- ntfy
- push-all-in-cloud

## 邮箱通知

使用 SMTP 服务发送邮件通知。

### 配置步骤

1. 打开"设置" -> "通知"
2. 选择"邮箱"
3. 填写配置信息

### 配置项

| 配置项      | 说明                 | 示例              |
| ----------- | -------------------- | ----------------- |
| SMTP服务器  | 邮件服务商的SMTP地址 | `smtp.qq.com`     |
| SMTP端口    | 通常为465或587       | `465`             |
| 发件人邮箱  | 你的邮箱地址         | `your@qq.com`     |
| 授权码/密码 | 邮箱授权码或密码     | `abcd1234efgh`    |
| 收件人邮箱  | 接收通知的邮箱       | `receiver@qq.com` |
| 使用SSL     | 是否使用SSL加密      | `是`              |

### 常见邮箱配置

#### QQ邮箱

- SMTP服务器：`smtp.qq.com`
- 端口：`465`
- SSL：`是`
- 密码：使用授权码（在QQ邮箱设置中生成）

#### 163邮箱

- SMTP服务器：`smtp.163.com`
- 端口：`465`
- SSL：`是`
- 密码：使用授权码

#### Gmail

- SMTP服务器：`smtp.gmail.com`
- 端口：`587`
- SSL：`是`
- 密码：使用应用专用密码

#### Outlook

- SMTP服务器：`smtp.office365.com`
- 端口：`587`
- SSL：`是`

::: tip 提示
每个邮件服务商的参数各不相同，使用前请参照各服务商的教程。
:::

### 故障排除

**无法发送邮件**

1. 检查SMTP服务器和端口是否正确
2. 确认使用的是授权码而不是登录密码
3. 检查是否启用了SMTP服务
4. 确认网络连接正常

## Server酱

Server酱支持免费推送信息到手机微信，免费账户有限制。

### 配置步骤

1. 访问 [Server酱官网](https://sct.ftqq.com/)
2. 微信扫码登录
3. 获取 SendKey
4. 在软件中填入 SendKey

### 配置项

| 配置项  | 说明           |
| ------- | -------------- |
| SendKey | Server酱的密钥 |

### 使用限制

免费版限制：

- 每日推送次数限制
- 推送内容长度限制

付费版可以解除限制，详见[官网](https://sct.ftqq.com/)。

### 故障排除

**无法接收通知**

1. 检查 SendKey 是否正确
2. 检查是否超过每日推送次数
3. 检查微信是否关注了公众号

## Telegram Bot

通过 Telegram Bot 发送通知到你的 Telegram。

### 配置步骤

1. **创建Bot**

   - 在 Telegram 中找到 `@BotFather`
   - 发送 `/newbot` 创建新Bot
   - 按提示设置Bot名称
   - 获取 Bot Token

2. **获取Chat ID**

   - 在 Telegram 中找到 `@userinfobot`
   - 发送任意消息
   - 获取你的 Chat ID

3. **配置软件**
   - 打开"设置" -> "通知"
   - 选择"Telegram Bot"
   - 填入 Bot Token 和 Chat ID

### 配置项

| 配置项    | 说明               | 示例                |
| --------- | ------------------ | ------------------- |
| Bot Token | Bot的访问令牌      | `123456:ABC-DEF...` |
| Chat ID   | 你的Telegram用户ID | `123456789`         |

### 使用群组

也可以将通知发送到群组：

1. 创建群组并添加Bot
2. 获取群组的Chat ID（通常以`-`开头）
3. 在软件中填入群组Chat ID

### 故障排除

**无法发送消息**

1. 检查 Bot Token 是否正确
2. 检查 Chat ID 是否正确
3. 确认已在 Telegram 中启动了Bot（发送 `/start`）
4. 确认网络可以访问 Telegram

::: tip 提示
国内网络可能需要代理才能访问 Telegram。
:::

## ntfy

[ntfy](https://ntfy.sh/) 是一个开源的推送服务，支持多平台。

### 配置步骤

1. 访问 [ntfy.sh](https://ntfy.sh/)
2. 创建一个 Topic（主题）
3. 在手机上安装 ntfy 应用
4. 订阅你的 Topic
5. 在软件中配置

### 配置项

| 配置项     | 说明             | 示例                        |
| ---------- | ---------------- | --------------------------- |
| 服务器地址 | ntfy服务器地址   | `https://ntfy.sh`           |
| Topic      | 推送主题         | `my-bililive-notifications` |
| Token      | 访问令牌（可选） | `tk_xxx`                    |

### 自建服务器

也可以自建 ntfy 服务器，参考 [官方文档](https://docs.ntfy.sh/)。

### 故障排除

**无法接收通知**

1. 检查 Topic 是否正确
2. 确认手机应用已订阅该 Topic
3. 检查服务器地址是否正确
4. 检查网络连接

## push-all-in-cloud

[push-all-in-cloud](https://github.com/CaoMeiYouRen/push-all-in-cloud) 是一个支持多种推送方式的统一推送服务。

### 功能特点

- 支持多种推送平台
- 统一管理推送配置
- 减少在客户端暴露密钥的风险
- 支持自定义推送模板

### 支持的平台

- Server酱
- Bark
- Pushplus
- WxPusher
- 钉钉
- 企业微信
- 飞书
- 等等...

### 配置步骤

1. 部署 push-all-in-cloud 服务
2. 在服务中配置推送平台
3. 获取 API 地址和密钥
4. 在软件中填入配置

### 配置项

| 配置项  | 说明                       |
| ------- | -------------------------- |
| API地址 | push-all-in-cloud的API地址 |
| 密钥    | 访问密钥                   |

### 故障排除

**无法推送**

1. 检查 push-all-in-cloud 服务是否正常
2. 检查 API 地址是否正确
3. 检查密钥是否正确
4. 检查在服务中配置的推送平台是否正常

## 通知事件

可以为不同的事件配置是否发送通知。

### 支持的事件

| 事件     | 说明           |
| -------- | -------------- |
| 录制开始 | 开始录制直播时 |
| 录制结束 | 录制结束时     |
| 上传开始 | 开始上传视频时 |
| 上传完成 | 视频上传完成时 |
| 上传失败 | 视频上传失败时 |
| 处理开始 | 开始处理视频时 |
| 处理完成 | 视频处理完成时 |
| 处理失败 | 视频处理失败时 |
| 同步开始 | 开始同步文件时 |
| 同步完成 | 文件同步完成时 |
| 同步失败 | 文件同步失败时 |

### 配置示例

只通知重要事件：

- ✅ 上传完成
- ✅ 上传失败
- ❌ 录制开始
- ❌ 录制结束

全部通知：

- ✅ 所有事件

## 通知内容

通知内容包含：

- 事件类型
- 时间
- 相关信息（如视频标题、房间号等）
- 状态（成功/失败）
- 错误信息（如果失败）

### 自定义模板

部分通知方式支持自定义通知模板，可以根据需要调整通知内容格式。

## 测试通知

配置完成后，建议先发送测试通知：

1. 配置好通知方式
2. 点击"测试"按钮
3. 检查是否收到通知

## 多种通知方式

可以同时配置多种通知方式，每种方式可以配置不同的事件。

示例：

- 邮箱：接收所有通知
- Server酱：只接收失败通知
- Telegram：只接收完成通知

## 通知频率限制

为避免骚扰，建议：

1. 不要通知所有事件
2. 只通知重要事件
3. 合并相似通知
4. 设置免打扰时段

## 隐私与安全

### 本地存储

所有通知配置都存储在本地，不会上传到任何服务器。

### 信息保护

请妥善保管：

- SMTP密码/授权码
- Bot Token
- API密钥
- 等敏感信息

不要分享给他人，不要截图发到公开场合。

### 加密传输

支持 SSL/TLS 的通知方式会加密传输，保护信息安全。

## 故障排除

### 通用问题

**所有通知都无法发送**

1. 检查通知开关是否启用
2. 检查事件是否勾选
3. 查看日志获取详细错误

**通知延迟**

- 网络延迟
- 服务商限流
- 正常现象，无需担心

**通知丢失**

1. 检查是否超过服务商限制
2. 检查垃圾邮件箱（邮件通知）
3. 检查应用权限（手机应用）

### 特定平台问题

参考各平台的故障排除部分。

## 最佳实践

### 1. 选择合适的方式

- 国内用户：Server酱、邮箱
- 国外用户：Telegram Bot、ntfy
- 技术用户：push-all-in-cloud

### 2. 合理配置事件

只通知你关心的事件，避免信息过载。

### 3. 测试后再使用

配置完成后先发送测试通知，确认可用。

### 4. 备份配置

导出配置时会包含通知配置（敏感信息会加密）。

### 5. 定期检查

定期检查通知是否正常工作，避免错过重要信息。

## 下一步

- [Webhook](./webhook.md) - 配置自动化处理
- [文件同步](./file-sync.md) - 同步到云存储
- [自动上传](./auto-upload.md) - 配置自动上传
