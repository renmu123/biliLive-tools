# 2.0.0

## 功能

- 支持斗鱼录播订阅下载 [#64](https://github.com/renmu123/biliLive-tools/issues/64)
- 新增看板页面
- Web支持首页预览功能
- Web支持切片功能
- 录制：B站支持标题关键字参数（仅在开启弹幕时生效）
- 视频合并页面支持弹幕合并 [#75](https://github.com/renmu123/biliLive-tools/issues/75)

## 优化

- 录制：抖音支持解析 `https://v.douyin.com/xxx/` [#73](https://github.com/renmu123/biliLive-tools/issues/73)
- 录制：B站修改默认画质匹配逻辑以处理hevc真原画

# 1.10.1(2025.4.20)

## 优化

- 分段录制时会下载最新封面以及使用最新标题

# 1.10.1

## 优化

- 检查更新增加备用下载地址
- 弹幕读取时间戳函数可能存在无法停止的问题，添加了额外的超时处理
- 支持hevc flv的视频切片 [#72](https://github.com/renmu123/biliLive-tools/issues/72)
- 优化在一个检查期间上传多个稿件导致多次发送通知的情况
- ffmpeg中止任务时，现在会默认保存进度
- 首页压制支持mkv文件
- B站支持qn线路

## Bug修复

- 修复视频编码为 `copy` 时，无法保存预设的bug
- 修复 scale 相关参数在暗黑模式下的错误UI
- 修复审核通过后无法发送评论和置顶的bug
- 修复本软件录制无法使用时间戳功能的bug
- 修复 `videoFormat=auto` 时开启分段结束后的重命名错误

# 1.10.0(2025.4.12)

## 破坏性功能

- **录制：移除“转封装为mp4”，作为替换，你可以使用录制格式参数或者在webhook中进行转封装**

## 功能

- `scale` 支持 `force_original_aspect_ratio` 参数，优化分辨率配置UI
- Win 下安装包支持自定义安装位置
- 开播通知支持其他通知选项
- 录制：斗鱼支持线路选择
- 录制：支持录制格式参数： "auto", "ts", "mkv"
- ffmepg参数：分辨率中新增“pk优化”参数，解决上传B站后pk视频被拉伸，启用之后：“强制宽高比”参数会被强制为“缩小”，会添加“pad=with:height:(ow-iw)/2:(oh-ih)/2”滤镜。在webhook使用时转码时进行分辨率检测，只会存在多个分辨率时才会进行转码（不针对弹幕）。如果你使用cpu转码，推荐码率控制使用crf，并设置在23或更大，再根据配置调整 preset 参数
- 视频合并支持复制第一个视频的元数据 [#66](https://github.com/renmu123/biliLive-tools/issues/66)
- 客户端任务栏图标新增重启功能
- tg 通知支持反代url [#69](https://github.com/renmu123/biliLive-tools/issues/69)
- 虎牙增加弹幕重连次数，默认为10
- 支持自定义HTTP通知，真的是最后一个通知了

## 优化

- 切片&转码支持直接选择`mkv`文件
- 斗鱼&B站&抖音弹幕链接增加更多重试次数，默认为10
- app端存在录制中视频关闭时尝试停止录制后再关闭软件

## Bug修复

- 修复录制开始通知条件错误显示&以及无法正常使用的bug
- 修复抖音礼物弹幕时间戳错误
- 修复 hevc_amf 和 av1_amf 编码下错误的 preset 参数 **注意之前的参数需要重新修改**

# 1.9.1

## 优化

1. 任务列表中上传视频名称同时显示分p名称和视频文件名 [#56](https://github.com/renmu123/biliLive-tools/issues/56)
2. 上传视频时支持将视频文件名应用到预设标题中 [#60](https://github.com/renmu123/biliLive-tools/issues/60)
3. 为支持的按钮添加快捷键提示（PS：我都忘了还支持过快捷键）
4. 优化审核相关操作的查询策略，减少请求
5. "自动更新授权"在存在上传任务时不会进行更新，一个小时后重新尝试
6. “手动更新授权”增加正在上传任务检测，增加提醒
7. 切片：关闭视频时同时清除切片数据
8. 切片：优化部分文案，增加快捷键提示
9. 切片：移除 ctrl+shift+k 快捷键，使用 ctrl+k 快捷键进行切换，减轻心智负担
10. 录制：添加B站直播间，且未设置录制账号时，添加额外提示

## Bug修复

1. 修复虎牙星秀区无法录制的bug，感谢 https://github.com/ihmily/DouyinLiveRecorder/pull/993
2. 修复某些 web 环境下无法复制 cookie 的 bug [#62](https://github.com/renmu123/biliLive-tools/issues/62)
3. 修复 webui 授权错误时未正确跳转的 bug
4. 修复某些情况下查询稿件失败而导致的审核通知错误
5. 切片：修复部分按钮无法点击的 bug
6. 修复录制配置中“录制文件夹”默认打开文件夹错误的bug
7. 修复 webhook 中“上传后删除源文件”选项失效的bug

# 1.9.0

## 破坏性更改

1. **由于虎牙支持精细画质，画质需要重新配置，默认为原画画质**
2. **移除webhook中的“使用视频文件名”参数，模板中增加`{{filename}}`参数，移除了标题的不再维护警告**
3. **重新使用 ffmpeg 7.1版本，移除amd硬件过滤器支持**
4. **不再提供编译后的CLI应用，请优先使用docker或者node安装**

## 功能

1. 录制：支持开播通知
2. 录制：虎牙支持精细画质
3. 录制：支持抖音直播录制
4. 录制：斗鱼支持标题关键词来不进行录制 [#53](https://github.com/renmu123/biliLive-tools/pull/53)
5. 录制：客户端支持开播通知
6. 硬件解码又被加回来了，仅在未使用滤镜被添加
7. 转码功能支持高能进度条
8. 支持导入导出弹幕配置
9. 弹幕文字支持根据分辨率进行自适应
10. 移除webhook中的“使用视频文件名”参数，模板中增加`{{filename}}`参数，移除了标题的不再维护警告
11. Webhook分p标题支持自定义，默认为文件名，不含后缀， 支持主播名、标题、房间号、文件名、序号（从1开始）、时间相关 参数
12. B站下载视频时支持弹幕
13. 切片支持ts文件
14. webhook转封装支持“封装后删除源文件”选项来控制是否删除源文件
15. webhook独立配置支持复制操作

## 优化

1. 录制：虎牙配置时不显示“高能弹幕”配置
2. 录制：支持直接打开webhhook配置页
3. 录制：优化B站hls流的录制，ts流比fmp4优先级更高
4. 录制：B站弹幕服务增加自动重试
5. 录制：B站"避免hls自动分段"选项默认开启
6. 录制：斗鱼礼物弹幕支持“开通钻粉”和“续费钻粉”
7. 录制：虎牙画质支持蓝光20M,蓝光10M
8. 录制："调试模式"参数默认为关闭
9. 录制：录制列表模式部分字段添加排序
10. 录制：`画质匹配重试次数` 支持`-1`参数，用于强制匹配画质，虎牙支持了该参数
11. 录制：B站批量查询不再依赖于uid，所有直播都可以使用
12. 录制：优化配置UI
13. ffmpeg预设增加分辨率验证
14. 优化减少部分页面的多余接口请求
15. B站的合集和分区增加缓存
16. 单独弹幕转换开启“自适应分辨率”选项时，增加额外提示
17. 切片页支持关闭视频
18. 设置选项的tab可以被记住
19. 上传默认重试次数修改为7
20. webhook中的房间号增加更多验证

## Bug修复

1. 录制：修复添加虎牙直播间时，默认画质参数错误的bug
2. 录制：修复虎牙画质未生效的bug
3. 录制：修复斗鱼全局画质未获取到的bug
4. 录制：虎牙“星秀”分区直播不再破碎，也有可能带来其他问题，如果有请反馈
5. 录制：修复B站"避免hls自动分段"未生效的bug
6. 录制：修复B站“批量查询接口”某些情况下进行额外查询的bug
7. 修复二次编辑时话题未被保存的bug [#51](https://github.com/renmu123/biliLive-tools/issues/51)
8. 修复启动后进入时视频预设可能未正常显示的bug

# 1.8.0

## 主要更新

1. 完善对B站直播录制的支持，包括了b站所有支持的流，以及更多的控制参数
2. 新增了web版本更多功能支持
3. 新增了更多的自动化，如账号cookie自动更新，审核通过后删除视频，硬盘容量检测，来减少错误后的处理成本
4. 更新ffmpeg支持了flv非标hevc，增加了更多ffmpeg选项，支持了scale的硬件过滤器

## 破坏性更改

**更新ffmpeg版本，新增对flv下非标hevc的支持，如果遇到硬件编码无法使用，请尝试更新驱动，或尝试更新较老版本的ffmpeg，n卡驱动要求570及以上**

1. 由于斗鱼支持精细画质，画质需要重新配置，默认为最高画质

## 功能

1. 转码页面支持压制弹幕 [#45](https://github.com/renmu123/biliLive-tools/issues/45)
2. 首页压制支持web版本
3. 新增选项支持自动更新账号授权
4. 用户页新增复制cookie按钮
5. B站录制支持hls以及fmp4的avc以及hevc，~~**hls及fmp4流录制一个小时后被自动分段，如果你确定主播的流没有flv，请确保分段时间不为一个小时**~~通过代理并重写m3u8来支持分段
6. 上传支持审核通过后删除选项
7. B站&斗鱼录制支持“画质匹配重试次数”选项
8. 支持录播姬&直播录制文件夹空间检测通知
9. Webhook压制配置支持“限制处理时间”参数
10. 斗鱼支持精细画质选项
11. B站录制支持批量查询接口，**只有此版本后添加的直播间才支持**
12. 支持下载虎牙录播
13. 移除单独的硬件解码选项，新增n卡,qsv,a卡在某些情况下支持使用硬件scale过滤器选项，增加速度，**可能会破坏自定义滤镜，如果有请报告**
14. 任务队列中支持删除ffmpeg失败和完成状态下的输出文件

## 优化

1. 优化任务查询的轮询，现在只会在任务页查询，数量功能使用sse实现
2. 优化web的文件夹选择框
3. 优化配置文件导入
4. 斗鱼弹幕录制增加自动重连以及错误报告
5. 弹幕预设保存增加验证
6. 录制命名规则修改增加提示避免错误修改
7. 优化webhook中上传的限制时间的实现，修改为加入队列，之后自动启动
8. 切片导出时支持忽略弹幕选项
9. 优化录制时停止功能，修改为暂停此场录制
10. 为录制的弹幕中增加开播时间元数据
11. 移除“观看直播功能”
12. web版支持视频合并选择文件夹
13. 优化docker镜像大小
14. 重构视频下载，增加部分验证
15. 分辨率插值算法默认参数修改为 'auto'，也即由滤镜自行决定；libsvtav1的preset默认值修改为10；amf增加preset参数；ffmpeg支持编码线程数参数
16. 优化web登录提示，增加登出按钮
17. 放松webhook"上传非弹幕版"选项限制，当选项开启时，上传非弹幕版不会触发删除源文件相关操作
18. 弹幕转换支持“跳过存在文件选项”
19. ffmpeg预设保存时增加更多验证

## Bug修复

1. 修复在“上传非弹幕版”时同时选择“转封装为mp4”选项有概率失败的bug
2. 修复视频下载，视频合并在web下某些情况下错误的bug
3. 修复docker默认字体被覆盖的bug

# 1.7.2

## 优化

1. 优化弹幕转换的中礼物相关的提示
2. 隐藏“发送至webhook”功能，某些情况下可能导致奇怪的问题
3. 录制功能的调试模式默认值修改为开启
4. log等级配置的更改实时生效
5. 为B站预设新增封面文件大小校验

## Bug修复

1. 修复b站接口更改导致的分p续传失败的bug
2. 修复录制单独设置B站录制账号不生效的bug
3. 修复某些情况下导入配置文件失败的bug

# 1.7.1

## 功能

1. 录制支持选项快速转换为mp4格式
2. 用户页新增更新授权按钮

## Bug修复

1. 修复某些情况下B站录制弹幕解析失败
2. 修复录制模式调试日志无法关闭的bug
3. 修复某些情况下录制未被中断的bug
4. 修复列表模式下监听状态文案错误的bug
5. 修复录制单独设置B站录制账号未正确显示的bug
6. 修复账号过期时间未显示的bug
7. 修复切片时视频获得焦点时无法使用空格暂停的bug
8. 修复切片在未选择弹幕时仍显示高能进度条的bug
9. 修复切片弹幕未正常显示的bug

# 1.7.0

## 破坏性更新

1. **~~为了多端兼容性考虑，字体的获取不再使用浏览器特有的api，此项更新后可能出现字体显示错误的情况。~~ 为了兼容性考虑，客户端仍使用web api，web端将使用新api，两者可能并不兼容**
2. **封面将统一保存在文件夹下，一来为了多端兼容性、二来更方便的进行配置迁移，大概不会破坏目前的兼容性，还请自查，如果是web版本，只有本版本上传的才能预览**

## 功能

1. 支持斗鱼、虎牙、B站直播录制，感谢[LiveAutoRecord](https://github.com/WhiteMinds/LiveAutoRecord)，绝大部分录制代码都来自该项目
2. web版本支持，现在可以使用web来管理cli或者远程本地，并非有所有客户端功能都会被支持，**如果你的接口是http协议，由于浏览器安全措施，需要关闭https和http混合的安全选项，或者选择[自部署](https://github.com/renmu123/biliLive-webui/tree/webui)**，线上地址：https://bililive.irenmu.com
3. ffmpeg预设中的"时间戳"功能支持字体跟随弹幕预设，自定义内容格式（具体见[strftime](https://strftime.org/)，`:`需要转义），额外自定义参数（见[ffmpeg文档](https://ffmpeg.org/ffmpeg-filters.html#drawtext-1)） [#38](https://github.com/renmu123/biliLive-tools/issues/38)，优化webhook中参数的获取
4. 支持 [push-all-in-cloud](https://github.com/CaoMeiYouRen/push-all-in-cloud) 推送
5. 更新额外的上传线路，**设置自定义上传先线路的可能需要手动更新，虽然也做了兼容**
6. 压制时ass支持高能进度条
7. 预览支持高能进度条
8. 重写切片部分UI，主要是高能进度条与弹幕搜索，目标是减少会导致中断的操作，新增`ctrl+k`和`ctrl+shift+k`快捷键，移除sc视图
9. 压制支持推送到webhhook
10. B站下载支持设置最大任务处理数，只下载音频选项，超时重试逻辑
11. B站上传支持限速

## 优化

1. 修改弹幕预设默认值，字体大小：38->40、阴影：1->0、描边：0->1、滚动显示区域：1->0.7、显示礼物框：显示->不显示、Linux默认字体：思源黑
2. 修改英伟达默认ffmpeg参数：medium->fast
3. ffmpeg最大任务数默认值修改为3，B站上传默认值修改为2
4. 配置备份支持封面
5. log查看页面支持导出，移除任务栏菜单的“打开log文件夹”选项
6. 优化任务查询接口
7. **为自动评论添加提示，谨慎使用，可能会导致评论被shadowban，以及可能的风控等级上升**
8. ffmpeg依赖版本升级
9. 转码、弹幕转换支持相对文件夹、完成后删除源文件选项
10. 优化队列清除记录接口请求

## Bug修复

1. 修复访问不存在的接口时错误返回信息
2. 修复CLI有概率错误退出的bug（蜜汁这个版本就没有了）
3. 修复视频预设标题超过80字符无法保存的bug [#41](https://github.com/renmu123/biliLive-tools/issues/41)
4. 修复windows下的删除到回收站失效
5. 修复关闭登录弹框时未清除定时器 [#43](https://github.com/renmu123/biliLive-tools/issues/43)
6. 修复使用copy预设切片时时间戳错误的情况

# 1.6.2(2024.12.5)

## CLI

修复无法使用的bug

# 1.6.1(2024.12.1)

## 优化

1. 增加web版本不一致提示

## Bug修复

1. 修复某些情况下客户端页面可能空白的情况
2. 修复webhook开启“转换后移除源文件”选项后弹幕未被删除的bug
3. 修复弹幕黑名单用户名的描述错误
4. 修复转码功能中对预设“视频分辨率”无效的bug [#37](https://github.com/renmu123/biliLive-tools/issues/37)
5. 修复续传时无法选择在合集中稿件的bug
6. 修复编码器为copy时显示滤镜输入框的bug
7. 修复某些情况下 CLI 写入日志失败

# 1.6.0(2024.11.12)

历时两个多月的大版本来了，虽然主要的几个功能（如直播录制、docker版本）这个版本都没有发布，但是地基已经打好，下个版本见。

但是还是实现了一些有意思的功能，我其中最喜欢的还是添加了B站审核状态的通知，不需要再为关注状态而心累。  
ffmpeg支持滤镜给了更大的操作空间来处理视频，硬编码时间到视频中能给切片man更大的便利，不必再根据时间来反推精彩的点。

## 破坏性变更

1. **上传预设标题支持模板用于替代webhook中的标题模板，目前如果预设标题中不存在占位符，为了兼容性考虑，依然使用webhook配置，预计后续版本中会移除此字段，请使用者尽快迁移**
2. **B站登录信息加密保存，也可以使用环境变量`BILILIVE_TOOLS_BILIKEY`自定义密钥，web版本用户尤其推荐，自定义前请先退出原有全部账号，windows下环境变量修改后可能需要重启电脑方能生效**

## 功能

1. B站视频审核状态检测通知
2. 支持DDTV webhook，**需要将DDTV的软件“设置-文件与路径设置-录制文件保存路径”设置为绝对路径**
3. 弹幕转换新增“时间偏移”参数
4. 斗鱼下载支持清晰度选择、不下载弹幕、覆盖控制选项
5. B站下载支持覆盖控制选项
6. ffmpeg参数支持视频滤镜选项
7. 支持硬编码时间参数到视频中，优先从webhook中读取、其次是弹幕元数据（支持录播姬、blrec、本软件下载的录播）、最后是视频元数据（如录播姬注释），即使你开启此选项，也是有可能不被渲染的
8. amf相关编码支持硬件解码
9. 在上传弹幕版本时同时支持上传非弹幕版

## 优化

1. 优化标题变量名插入时的位置
2. 优化任务的持续时间计算
3. 弹幕配置的简易模式默认为false
4. 为部分UI增加右键菜单 [#26](https://github.com/renmu123/biliLive-tools/issues/26)
5. 为已有的ffmpeg配置部分参数添加默认值
6. 标题模板支持 `{{roomId}}` 房间号参数
7. 队列增加暂停按钮
8. 上传预设中标签修改为不得超过十个
9. 重构上传预设标签输入框
10. 切片时支持不选中弹幕分割
11. window下cli支持ffmpeg任务暂停以及高能进度条
12. 将B站重试次数的默认值设置为7，时间为7秒

## Bug修复

1. 修复任务队列错误显示B站稿件提交后的“打开文件”按钮
2. 修复webhook从未设置上传者修改为有上传者时，将过去的稿件一并上传的bug
3. 修复windows下cli的打包错误
4. 修复上传重试次数设置未生效的bug，[上游修复](https://github.com/renmu123/biliAPI/commit/ee5611b8ffe2f8c49aba972ed9aa85b44a498bc9)
5. 修复导出切片出“跳过存在文件”失效的bug

## 其他

**将部分函数使用http协议重构，如果有bug请反馈，为之后的web版做准备**

# 1.5.3(2024.11.5)

## 优化

1. 由于简介好像统一为2000字了，移除额外的请求
2. 多p视频支持加入合集 [#33](https://github.com/renmu123/biliLive-tools/issues/33)

## Bug修复

1. 修复某些情况下无法导入配置文件的bug

# 1.5.2(2024.10.11)

## 功能

1. server酱<sup>3</sup>支持
2. 弹幕转换支持不保存屏蔽弹幕（仅支持部分，不支持主动屏蔽的弹幕） [#31](https://github.com/renmu123/biliLive-tools/issues/31)
3. B站上传选项支持可见范围参数

## 优化

1. 弹幕转换设置时的分辨率参数在开启“自适应分辨率”参数时仍可修改

## Bug修复

1. 修复某些情况下上传视频时任务状态持续为运行中 [#30](https://github.com/renmu123/biliLive-tools/issues/30)
2. 修复下载视频时默认视频标题中非法字符串未被过滤的bug
3. 修复上传时部分错误未被重试

# 1.5.1

## Bug修复

1. 修复host为0.0.0.0情况请求错误的bug [#23](https://github.com/renmu123/biliLive-tools/issues/23)

# 1.5.0

## CLI

由于我对CLI功能的不重视，~~大概也没人用~~，导致年久失修~~之后我一定好好测试~~，请升级的用户按照最新[文档](https://github.com/renmu123/biliLive-tools/tree/master/packages/CLI)重新进行配置并测试

**`binFolder`参数已被移除，请为可执行文件单独配置**

## 功能

1. B站上传优化，分P分开上传，支持上传重试、重试延迟、线路、并发、同时上传限制、自动评论检查间隔选项，暂时没有添加如手动重试等更多控制功能，如果有bug请反馈
2. webhook标题支持ejs模板引擎，具体使用见文档 ([#21](https://github.com/renmu123/biliLive-tools/issues/21))
3. 新增log直接查看功能
4. ffmpeg配置增加缩放算法，分辨率默认值修改为2880x1620
5. 缩放支持先缩放后渲染和先渲染后缩放两种模式
6. 用户页增加B站帐号过期时间
7. 弹幕过滤
   - 目前支持三种屏蔽方式，分别是弹幕内容，uid，用户名，需以**英文逗号**分隔
   - 弹幕内容：部分匹配，包含sc内容
   - uid：全匹配，格式为<10995238>，弹幕姬用户注意，即是你开启了记录raw，出于性能原因，此过滤也是无法使用的，请使用用户名替代
   - 用户名：全匹配，格式为[暮色312]

## 优化

1. 应用关闭时，对临时数据进行清理
   ~~切片时支持不选中弹幕分割~~忘记做了
2. 手动取消任务时不会触发错误事件
3. 斗鱼弹幕元数据增加`video_start_time`参数
4. webhook标题支持预览输出
5. 移除完成后删除源文件和完成后打开文件夹功能，由于这两个选项在各个页面中或无效或存在问题
6. 增加设置栏目
7. 移除弹幕转换的"同一用户相同礼物自动合并的时间窗"功能，上游[移除](https://github.com/hihkm/DanmakuFactory/pull/89)
8. 优化弹幕判空函数

## 其他

**将部分函数使用http协议重构，如果有bug请反馈，为之后的web版做准备**

## Bug修复

1. 修复断播续传设置关闭失效的bug
2. 修复弹幕姬未保存raw的sc价格，[上游修复](https://github.com/hihkm/DanmakuFactory/pull/91)
3. 修复某些情况下的缓冲区溢出，[上游修复](https://github.com/hihkm/DanmakuFactory/pull/94)

# 1.4.0

## 功能

1. 上传配置支持话题
2. webhook支持只在某段时间执行上传操作
3. 为首页增加预览窗弹框，**预览仅供参考，以实际渲染为主！**
4. 切片功能页支持高能弹幕以及sc分析，xml和ass均支持高能进度条，但是两者在不同的配置下会不同，两者的解析有不少区别
5. 为工具页面的确认按钮提供快捷键“ctrl+enter”快捷键操作
6. 优化设置中的可执行文件路径设置，增加选项是否开启自定义，默认为关，关了则使用软件默认路径，**之前有过自定义的需要手动启动**
7. 支持压缩包便携模式，数据保存在可执行文件路径下，在可执行文件所在文件夹创建一个`portable`文件，无拓展名如`.txt`
8. 支持斗鱼录播下载
9. 切片支持弹幕搜索

## 优化

1. 续传支持翻页
2. 优化文件拖拽栏拖拽
3. 错误推送事件会返回错误信息了
4. 当设置任务数量限制后，每当有任务暂停时，未开始任务会自动开始
5. 优化部分函数下读取视频时长失败时的错误处理
6. 优化弹幕姬弹幕大文件下高能弹幕的性能
7. 优化B站上传的重试机制

## Bug修复

1. 修复某些xml文件高能弹幕解析错误的bug
2. 修复DanmakuFactory的blrec价格解析错误，[由上游修复](https://github.com/hihkm/DanmakuFactory/pull/85)
3. 修复DanmakuFactory某些情况下转换ass内容错误，[由上游修复](https://github.com/hihkm/DanmakuFactory/pull/87)
4. 修复DanmakuFactory sc文本存在`\n`时，渲染ass错误，由[上游修复](https://github.com/renmu123/DanmakuFactory/commit/0df54629b382b3398bcea2be8a06e6e45f241ba3)
5. 修复推送成功事件被错误设置为开始事件的bug
6. 修复登录二维码第二次使用时错误使用上一个的bug

# 1.3.0

## DanmakuFactory性能优化

**win版本的DanmakuFactory并非使用官方项目，而是使用[自编译版本](https://github.com/renmu123/DanmakuFactory/tree/test)，大幅优化录播姬弹幕的转换速度**

## 切片工具页

很高兴给大家带来这个功能，这个功能是在软件一开始就被定下来制作的功能，由于某些原因~~懒~~一直被拖到了现在，这个版本终于和大家见面了，功能本身并不复杂，一些UI如何实现比较费我的脑子。

支持[lossless-cut](https://github.com/mifi/lossless-cut)项目导入直接读取~~使用该软件的用户有福了~~
，读取后可以针对视频和弹幕来进行局部渲染，如果你不使用该软件，我们页支持在软件中直接增加片段，以及支持ass在视频中渲染，本来不想做这个功能的，因为losslese-cut的体验已经非常优秀了，但写着写着就写完了，该工具页也带来了快捷键的支持。

你也可以在本软件中编辑后保存到llc项目，便于你进行二次编辑。

### 我们支持哪些快捷键

- `ctrl+s` 保存到llc项目
- `ctrl+shift+s` 另存为llc项目
- `ctrl+enter` 导出
- `ctrl+z` 撤销
- `ctrl+shift+z` 重做
- `I` 在当前时间开始当前片段
- `O` 在当前时间结束当前片段
- `up` 上一个片段
- `down` 下一个片段
- `del` 删除片段
- `space` 播放/暂停
- `ctrl+left` 后退1秒
- `ctrl+right` 前进1秒

## 功能

1. 首页工具栏支持续传
2. 增加切片工具页
   1. 支持导入lossless-cut项目文件
   2. 支持ctrl+s,ctrl+shift+s,ctrl+z,ctrl+shif+z,f2等快捷键，更多见文档
   3. 支持编辑后保存lossless-cut项目文件
   4. 支持局部渲染
3. qsv支持预设参数
4. 弹幕设置-不透明度设置修改为百分比参数，原参数弃用，**请使用者进行手动迁移修改**
5. 支持配置导入和导出
6. 弹幕转换支持“显示用户名”参数

## 优化

1. 优化弹幕黑名单使用原生实现
2. 优化webhook视频标题输入变量优化
3. 为应用添加最小宽高
4. 重构webhook方便写单元测试
5. 队列页面更好的错误显示

## Bug修复

1. 修复另存为ffmepg的cpu默认预设后切换其他部分编码器会转换失败的bug
2. 修复ffmpeg批量添加时最大任务设置可能失败的bug
3. 修复工具页切换时页面未被缓存的bug
4. 修复某些情况下无法修改稿件简介的[bug](https://github.com/renmu123/biliLive-tools/issues/4#issuecomment-2233626419)
5. 修复多P上传的暂停错误，由[上游修复](https://github.com/renmu123/biliAPI/commit/b07b25a2a7c61177abdc0d5b893e610d96b56ef1)
6. 修复上传暂停后进度计算错误，由[上游修复](https://github.com/renmu123/biliAPI/commit/c5106bc8710d950590878f3874323673414c5055)
7. 修复DanmakuFactory可执行路径存在空格时无法处理的bug
8. 修复文件拖拽栏可以选择任意文件的bug

# 1.2.0

## 功能

1. 弹幕密度增加按条数配置
2. 转封装页面升级为转码页面，支持对视频进行重编码
3. 版本更新后首次进入出现更新日志

## 优化

1. 工具页UI优化
2. ffmpeg预设增加copy预设
3. 弹幕压制时如果视频编码器为copy则报错
4. 弹幕配置的“简易模式”可以被记住

## Bug修复

1. 修复多个b站账户同时操作时cookie有概率混淆 [#16](https://github.com/renmu123/biliLive-tools/issues/16)
2. 修复“断播续传”与“使用直播间封面”功能同时使用时，“使用直播间封面”功能失效的bug [#17](https://github.com/renmu123/biliLive-tools/issues/17)
3. 修复webhook增加房间时保存了额外不必要数据的bug
4. 修复“打开稿件”按钮错误的bug

# 1.1.0

## 功能

1. ntfy推送支持
2. 系统推送支持，仅限app,CLI无法使用
3. webhook支持"不压制后处理"
4. 新增对ffmepg 编码器copy参数的支持
5. 新增对ffmepg audio参数的支持
6. webhook上传标题支持`{{HH}}``{{mm}}``{{ss}}`小时，分钟，秒格式化字段
7. Linux下的zip包支持

## 优化

1. 弹幕转换&转封装保存到特定文件夹时验证文件夹是否存在
2. 修改菜单栏展开时占据的空间，展开状态可以被记住

## Bug修复

1. 修复webhook弹幕转换后未清理临时ass文件的Bug
2. 修复webhook中“使用文件作为文件名”失效的bug

# 1.0.0

**整体架构调整，为支持CLI以及网页版做准备，如果有任何bug请及时反馈**

## 开发者的屁话

经过的大半年的开发，这个软件总算进入了1.0版本，时间是过得真快啊，我推得某些V都因为某些原因不看了，我也用不着传录播了，自己用得次数反而变少（笑），只是偶尔传传自己的录播，都怪B站屎一样的上传系统。

感谢那些帮助软件迭代开发的用户，我也希望这个软件可以帮助到部分有需要的人，减少一点做录播的门槛，，节约些许时间，但请让我知道你们正在使用本软件，无论是B站带上软件tag还是赞助我[爱发电](https://afdian.net/a/renmu123) 、[B站充电](https://space.bilibili.com/10995238)还是关注[我](https://space.bilibili.com/10995238)

接下来谈一下这个项目之后可能的需求，优先会做我自己的需求~~已经没啥需求了~~，如果你有什么需求，可以提issue，如果你不提那我肯定看不到  
~~1. 我一直很想做的是根据弹幕出现频次做切片功能，但是因为我不切片了，所以这个功能被鸽了~~
~~2. web版的支持以及cli的扩充，这个需求不有趣，所以看心情~~

1. 批量压制转码工具页，UI已经脑补完了
2. 斗鱼录播下载，很奇怪市面上竟然没有类似的工具
3. srt ai翻译，单纯是为我自己偶尔的烤肉

## webhook端点修改

**webhook的请求端点修改，请使用者进行迁移**
B站录播姬：`/webhook`修改为`/webhook/bililiverecorder`  
blrec：`/blrec`修改为`/webhook/blrec`  
自定义：`/custom`修改为`/webhook/custom`

## CLI的使用

CLI是GUI的拓展，使用前需要设置相关目录，由于配置文件很多且复杂，推荐在GUI中生成并进行修改配置后复制到CLI所配置的目录，或直接将目录设置为GUI的配置目录。  
暂时只支持webhook相关的指令，也即启动webhook server，可以避免启动electron带来的消耗。

**CLI版本暂时不支持删除到回收站，高能进度条功能**

## 最大任务数的相关说明

1. 目前只支持ffmepg任务最大任务数，可以在“设置-任务-ffmpeg最大任务数”中进行设置，默认为不限制
2. 手动暂停的任务不会被自动启动
3. 当任务暂停时，不会有任务被自动启动，也就是说只有当任务完成或者失败时才会自动启用下一个未开始的任务
4. 高能进度条任务会自动进行，因为速度会很快

## 特性

1. 为文件选择栏增加更多功能
2. 暗色模式支持
3. 视频预设增加“高级选项”参数，支持自定义ffmpeg输出参数，libsvtav1高级参数默认为`-svtav1-params tune=0`，libsvtav1支持10bit参数，qsv支持ICQ模式
4. cli支持
5. ffmpeg任务支持设置最大任务数
6. 为ffmpeg任务在“中止”操作时添加“保存进度”选项， **默认不保存，之前行为为默认保存**
7. 为弹幕转换增加屏蔽词功能，如果出现开启后无法转换的情况请反馈
8. 弹幕转换任务支持取消操作
9. 新增 `danmakuFactory路径`、`port`、`host`配置，webhook服务器自启动，默认为18010端口
10. 新增 `/webhook/bililiverecorder` 、`/webhook/blrec`、`/webhook/custom` webhook端点，移除`/webhook`、`/blrec`、`/custom`端点

## 优化

1. ffmpeg 版本升级至7.0
2. 登录优化（退出账号后默认使用第一个账号）
3. 修改ffmpeg预设中cbr名称为“平均比特率”
4. server酱的key输入框type设置为password
5. 修改视频合并的进度条计算，现改为使用时间长度计算，由于ffmpeg7.0中合并时frame参数不见了
6. 修改上传参数的排序，尽量与B站web端保持一致
7. 优化webhook上传后aid查询
8. 交换“中止”和“删除记录”的icon
9. 为部分弹框增加“不再提示”按钮
10. 在webhook弹幕转换时复制输入文件到临时文件夹来避免某些情况下danmafactory读取文件失败，比如文件名有emoji
11. hvenc下cq**默认值修改为28**，**使用的是-rc vbr而非-rc constqp**

## Bug修复

1. 修复hvenc下cq失效的bug
2. 修复hvenc下预设名称错误的bug [#13](https://github.com/renmu123/biliLive-tools/pull/13)
3. 修复libsvtav1 预设展示错误，**默认值修改为6**
4. 修复某些情况下登录后获取信息失败
5. 修改弹幕为空的判断逻辑，如果文件中存在`</d>`, `</gift>`, `</sc>`, `</guard>`任意标签则认为不为空
6. 修复blrec的webhook无法使用的bug [#15](https://github.com/renmu123/biliLive-tools/issues/15)

# 1.0.0-aplha.1

**上个版本的host设置有误，可能导致webhook无法访问，请修改为127.0.0.1（仅对本机开放），或0.0.0.0（其他机器可访问）**  
**整体架构调整，为支持CLI以及网页版做准备，如果有任何bug请及时反馈**  
**webhook的请求端点修改，请使用者尽快进行迁移，将会在1.0.0正式版中被移除**

B站录播姬：`/webhook`修改为`/webhook/bililiverecorder`  
blrec：`/blrec`修改为`/webhook/blrec`  
自定义：`/custom`修改为`/webhook/custom`

## 最大任务数的相关说明

1. 目前只支持ffmepg任务最大任务数，可以在“设置-任务-ffmpeg最大任务数”中进行设置，默认为不限制
2. 手动暂停的任务不会被自动启动
3. 当任务暂停时，不会有任务被自动启动，也就是说只有当任务完成或者失败时才会自动启用下一个未开始的任务
4. 高能进度条任务会自动进行，因为速度会很快
5. webhook中的mp4转码任务不会受限制

## CLI的使用

CLI是GUI的拓展，使用前需要设置相关目录，由于配置文件很多且复杂，推荐在GUI中生成并进行修改配置后复制到CLI所配置的目录，或直接将目录设置为GUI的配置目录。  
暂时只支持webhook相关的指令，也即启动webhook server，可以避免启动electron带来的消耗。

**CLI版本暂时不支持删除到回收站，高能进度条功能**

### 配置

使用前通过 `biliLive config gen` 生成默认配置文件，如果你已经安装客户端，相关配置会被自动设置（仅限win）

```js
{
  port: 18010, // 启动端口，如果不希望与客户端的冲突，请修改为其他端口号
  host: "127.0.0.1",  // host
  configFolder: "", // 配置文件夹，推荐在GUI中生成并进行修改配置后复制到CLI所配置的目录，可在“打开log文件夹”上一层文件夹找到
  binFolder: "",  // 二进制文件夹，如果你配置了选项，那么默认会从这个文件夹读取相关二进制文件
  ffmpegPath: "ffmpeg.exe", // 覆盖binFolder中的ffmpeg二进制路径
  ffprobePath: "ffprobe.exe",  // 覆盖binFolder中的ffprobe二进制路径
  danmakuFactoryPath: "DanmakuFactory.exe",  // 覆盖binFolder中的DanmakuFactory二进制路径
  logPath: "main.log",  // log文件路径
}
```

## 特性

1. cli支持
2. ffmpeg任务支持设置最大任务数
3. 为ffmpeg任务重在“中止”操作时添加“保存进度”选项， **默认不保存，之前行为为默认保存**
4. 主题现在可以跟着系统主题自动变化了
5. 为文件选择框增加“清空”操作

## 其他

1. 修改host默认值为 127.0.0.1
2. 修改部分深色模式的UI
3. 修改视频合并的进度条计算，现改为使用时间长度计算，由于ffmpeg7.0中合并时frame参数不见了
4. 修改上传参数的排序，尽量与B站web端保持一致

## Bug修复

1. 修复未正确记录任务相关的log
2. 修复log level未正确初始化的bug
3. 修复某些文件选择栏无法添加文件的bug
4. 修复ffmpeg 7.0版本下无法进行合并的 bug [#1265](https://github.com/fluent-ffmpeg/node-fluent-ffmpeg/pull/1265)

# 1.0.0-alpha

**本版本的host设置有误，可能导致webhook无法访问，请修改为127.0.0.1（仅对本机开放），或0.0.0.0（其他机器可访问）**

**这个版本有时间就把架构改了，经过大半年的开发，终于要进入1.0.0版本了，虽然还有好几个想做的需求没做**  
**整体架构调整，为支持CLI以及网页版做准备，如果有任何bug请及时反馈**  
**webhook的请求端点修改，请使用者尽快进行迁移，将会在1.0.0正式版中被移除**

B站录播姬：`/webhook`修改为`/webhook/bililiverecorder`  
blrec：`/blrec`修改为`/webhook/blrec`  
自定义：`/custom`修改为`/webhook/custom`

## 特性

1. 新增 `danmakuFactory路径`、`port`、`host`配置，webhook服务器自启动，默认为18010端口
2. 新增 `/webhook/bililiverecorder` 、`/webhook/blrec`、`/webhook/custom` webhook端点
3. 优化工具页的文件选择栏&部分组件UI优化
4. 暗色模式支持
5. 视频预设增加“高级选项”参数，支持自定义ffmpeg输出参数，libsvtav1高级参数默认为`-svtav1-params tune=0`，libsvtav1支持10bit参数，qsv支持ICQ模式
6. 为部分弹框增加“不再提示”按钮

## 其他

1. ffmpeg 版本升级至7.0
2. 登录优化（退出账号后默认使用第一个账号）
3. 修改ffmpeg预设中cbr名称为“平均比特率”
4. server酱的key输入框type设置为password

## Bug 修复

1. 修复hvenc下cq失效的bug，**默认值修改为28**，**使用的是-rc vbr而非-rc constqp**
2. 修复hvenc下预设名称错误的bug [#13](https://github.com/renmu123/biliLive-tools/pull/13)
3. 修复libsvtav1 预设展示错误，默认值修改为6
4. 修复某些情况下登录后获取信息失败

## 开发

1. 使用pnpm包管理器，修改架构为mono repo

# 0.13.0

**移除biliup支持**

## 特性

1. 移除biliup支持
2. 支持上传任务审核后自动评论
3. 优化下载任务选择
4. 新增最小化任务栏和关闭到任务栏选项，支持记住窗口位置和大小

## Bug修复

1. 修复某些情况下无法保存配置的bug

## 其他

1. electron 依赖升级至30版本

# 0.12.0

**预计之后的版本会移除biliup的支持，如果有还在使用的用户且认为有保留必要的，请发issue**

## 特性

1. 为通知增加测试按钮
2. 为webhook增加完成后删除文件选项
3. 支持开机自启动
4. 投稿分区修改为动态获取，支持不同分区的简介字数不同
5. 优化上传UI，支持修改分P名称以及拖动排序

## Bug fix

1. 修复高能进度配置项设置为全局失败的bug
2. 修复`nvenc`相关编码错误的默认预设参数

# 0.11.0

**预计之后的版本会移除biliup的支持，如果有还在使用的用户且认为有保留必要的，请发issue**

## 特性

1. 修改任务队列为在首页请求
2. 为不同任务增加不同的自定义参数，如下载速度，比特率，速度
3. webhook支持转封装为mp4选项
4. 弹幕压制支持文件名中带有空格的弹幕文件
5. 鼠标悬浮于进度条之上显示百分比进度
6. 上传预设合集增加“小节”，“此稿件不生成更新推送”选项、增加“二创声明”选项
7. webhook标题支持“使用文件名”选项
8. 为文件选择栏，统一增加“所有文件”选项
9. 为压制任务页面增加m4s支持
10. 房间号为空保存时增加提示

## Bug fix

1. 修复webhook中压制任务错误后状态未进行流转
2. 修复上传暂停后无法继续开始的bug
3. 修复弹幕为空时，压制失败的bug
4. 修复上传失败时，触发两次错误通知的bug

# 0.10.0

## 特性

1. 增加通知功能，支持邮件，server酱，tg bot
2. 弹幕压制支持分辨率缩放，可用于激活b站4k档位保证更高码率
3. nvidia相关编码增加cq和preset参数，以及支持硬件解码
4. 检查更新使用Chromium原生网络库，支持系统代理
5. “下载页”解析链接时增加加载过渡效果
6. 续传时添加提醒：已在合集中的稿件无法添加分P

## Bug fix

1. 修复ffmpeg设置中libsvtav1错误的预设参数
2. 修复无法为审核中的稿件续传的bug
3. 修复高能进度配置项设置为全局失败的bug

# 0.9.0

## 特性

1. 下载视频功能
2. 支持自定义webhook
3. webhook账号支持设置为无
4. 为视频合并增加默认标题
5. 部分按钮UI修改为图标
6. “打开文件夹”功能在打开时会尽可能选中文件

## Bug修复

1. 修复“弹幕转换”页面的“完成后打开文件夹”功能失效
2. 修复ffmpeg任务在暂停后删除任务后，ffmpeg进程未被释放的bug
3. 修复设置了房间号的情况下，全局上传预设为空时，不使用房间号内设置的预设的bug

# 0.8.2

## 特性

1. “压制任务”输出文件添加默认文件名
2. “压制任务”添加到队列后删除文件列表
3. 为队列添加名称筛选

## Bug fix

1. 删除“压制任务”时使用xml生成的中间临时ass文件
2. 修复“压制任务”的“移除源文件”选项为只有完成全部步骤后才会执行

# 0.8.1

**修复兼容性导致的新用户配置生成错误** 新用户请勿使用0.8.0版本

## Bug fix

1. 修复未勾选“高能进度条”时，ass文件无法用于压制的bug
2. 修复兼容性导致的新用户配置生成错误

## 特性

1. 为上传预设增加重命名操作
2. 为另存为与重命名操作增加回车快捷方式
3. 修改检查更新的代理github域名，我不D了
4. 取消ffmpeg任务的中断操作，中断操作的行为更换为中止操作

# 0.8.0

## Breaking change

webhook配置黑名单支持通配符，配置从黑名单优先修改为房间优先。  
之前为：黑名单优先，如果配置了黑名单，那么房间配置为开启也是没有效果的。  
现在修改为：房间配置优先，即如果房间配置了开启，那么即使配置黑名单也是无效的

## Bug fix

1. 修复某些情况下主页“完成后打开文件夹”选项失效
2. 修复主页弹幕预设没有“保存预设”选项
3. 修复webhook中弹幕自适应分辨率bug
4. 修复某些情况下上传预设设置错误的bug

## 特性

1. webhook支持使用直播间封面
2. 支持高能进度条
3. webhook标题支持更多参数
4. 上传预设支持合集参数
5. 优化房间配置
6. 增加录播姬工作目录可用性检查
7. 中断任务不再被认为完成状态，不会执行后续操作
8. UI优化
9. 为主页面的部分配置添加持久化

## 其他

依赖升级
UI优化

# 0.7.0

支持了非biliup上传，如需使用biliup上传，请在设置修改
房间支持单独开启关闭，已有数据默认为关，请手动开启

## 特性

1. 多账号支持
2. 移除biliup登录选项
3. 房间支持单独开启关闭，与黑名单共存
4. “断播续传”支持自定义时间间隔
5. 上传支持更多配置项，如关闭弹幕，关闭评论，开启精选评论，自制声明，开启充电面板
6. **支持非biliup上传**
7. 简介增加艾特用户功能
8. 增加赞赏功能
9. 退出时如果有任务存在增加提醒
10. 如果检测到webhook server从关闭更改为开启状态，提醒用户重启
11. 弹幕分辨率支持自适应视频分辨率

## 其他

1. 重构webhook房间配置
2. 重构配置项相关代码
3. 依赖升级

## Bug修复

1. 修复上传视频验证失效的bug

# 0.6.0

1. 支持同场直播上传到同一投稿
2. 如果预设正在被使用，删除时增加额外提醒
3. 重构弹幕预设的实现
4. 修复登录时未保存cookie的bug

# 0.5.0

1. 优化webhook，支持弹幕压制后上传
2. electron升级到28.0.0
3. 修复更换b站账号后cookie未刷新的问题
4. 增加非biliup实现的登录
5. 增加ffmpeg的预设设置
6. ffmpeg任务区分中断和中止操作
7. 修复弹幕密度默认设置错误
8. 修复续传视频后不提醒的bug

# 0.4.0

新增blrec的webhook支持  
增加队列页面，所有任务移入队列执行  
修复合并功能的ffmpeg参数错误  
优化压制功能  
优化合并功能的进度条计算

# 0.3.1

修复“弹幕设置-画面设置-调试”选项无法使用  
卸载时删除用户数据  
增加弹幕的预设功能  
修改ffmpeg中断信号  
修复上传预设不同步bug  
修复confirm组件的bug  
增加压制时预计剩余时间的显示

# 0.3.0

支持上传视频至b站  
支持合并视频工具  
支持选择删除文件或者删除至回收站  
增加自动更新检测

# 0.2.0

1. 打包自动化
2. 修复找不到 ffprobe 的 bug
3. 修复弹幕文件无法覆盖的 bug
4. 支持修改 ffmpeg 和 ffprobe 的可执行文件路径
5. 打包了没有 ffmpeg 和 ffprobe 可执行文件的安装包

# 0.1.0

1. 支持 Danmufactory GUI
2. 支持 ffmpeg 转封装
3. 支持视频与弹幕压制
4. 支持压制时修改 ffmpeg 部分配置项
