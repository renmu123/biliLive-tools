# B站上传

支持将视频文件上传至B站，支持单视频上传、多P上传、续传投稿等功能，提供自动化上传和手动上传两种方式。

## 功能介绍

B站上传功能可以帮助你：

- 快速上传视频到B站
- 支持多P视频上传
- 自动重试和断点续传
- 上传完成后自动检查审核状态
- 支持定时发布
- 支持合集功能
- 支持话题关联

## 快速开始

### 登录B站账号

上传前需要先登录B站账号：

1. 点击左侧头像区域
2. 选择"登录账号"
3. 使用B站APP扫描二维码
4. 等待登录成功

::: tip 多账号支持
软件支持多个B站账号，手动上传使用主账号
:::

### 手动上传视频

1. 打开"工具" -> "B站上传"
2. 添加要上传的视频文件（支持拖拽）
3. 配置上传参数（标题、简介、标签等）
4. 点击"开始上传"

### 自动上传（Webhook）

详见 [Webhook文档](./webhook.md)

## 上传配置

### 基础配置

#### 视频标题

视频标题，限制80个字符。

支持变量占位符（在Webhook中使用）：

- <code v-pre>{{title}}</code> - 直播标题
- <code v-pre>{{user}}</code> - 主播名
- <code v-pre>{{roomId}}</code> - 房间号
- <code v-pre>{{filename}}</code> - 视频文件名
- <code v-pre>{{now}}</code> - 录制时间（示例：2024.01.24）
- <code v-pre>{{yyyy}}</code> - 年
- <code v-pre>{{MM}}</code> - 月（补零）
- <code v-pre>{{dd}}</code> - 日（补零）

同时支持 [ejs模板引擎](https://github.com/mde/ejs) 语法。

#### 视频简介

视频简介，最多2000字符。

::: tip 换行
支持 @用户，可以输入[暮色312]<10995238>来进行艾特用户，前面的值为用户名，后面的值为用户id，请务必保持用户名与uid对应。
:::

#### 封面

上传封面图片，非必选。

- 如果不上传，B站会自动选择
- 文件过大会导致失败

### 版权设置

#### 版权类型

- **自制**：原创内容
- **转载**：转载他人内容

::: warning 转载视频
选择转载时必须填写"转载来源"。
:::

#### 转载来源

转载视频的来源URL或描述。

仅在版权类型为"转载"时需要填写。

#### 声明原创

禁止他人转载：

- **0**：允许转载
- **1**：禁止转载

#### 允许二创

允许他人使用你的视频进行二次创作：

- **1**：允许
- **-1**：不允许

### 音质设置

#### 杜比全景声

是否声明为杜比全景声。

::: warning 注意
仅在视频确实包含杜比音轨时选择。
:::

#### Hi-Res无损音质

是否声明为Hi-Res无损音质。

::: warning 注意
仅在视频确实包含无损音轨时选择。
:::

### 高级功能

#### 动态内容

发布视频时同步发送的动态内容，最多233字符。

#### 定时发布

设置视频的发布时间，**此选项不会被保存到配置中**

::: warning 定时发布要求

- 必须距离提交时间 > 2小时（7200秒）
- 只能设置未来的时间

:::

#### 自动评论

上传完成后自动在视频下方评论，**自动评论很容易被阿瓦隆**

可配置：

- 评论内容
- 是否置顶评论

#### 合集/视频列表

将视频添加到指定合集或视频列表。

#### 话题

关联视频到特定话题。

可以搜索话题并选择

## 上传预设

为常用的上传配置创建预设，避免重复填写。

### 创建预设

1. 配置好上传参数
2. 点击"保存为预设"
3. 输入预设名称
4. 下次直接选择预设即可

### 管理预设

在"设置" -> "上传预设"中可以：

- 查看所有预设
- 编辑预设
- 删除预设
- 设置默认预设

## 系统设置

在"设置" -> "B站设置"中配置上传相关的系统参数。

### 上传线路

选择上传使用的线路：

- **auto**：自动选择（推荐）
- **bda2**：百度云CDN
- **qn**：七牛云CDN（推荐海外服务器使用）
- **ws**：网宿CDN
- **bldsa**：其他线路

::: tip 线路测试
可以在 [B站预上传测速页面](https://member.bilibili.com/preupload?r=ping) 测试各线路速度。

如果上传经常失败，建议手动测试并选择最快的线路。
:::

### 上传性能

#### 并发数

::: warning 并发设置
并发过高可能导致网络拥堵或触发限制。
:::

#### 限速

限制单个上传任务的速度（KB/s）：

- 0：不限速
- 其他值：限制速度（如 1024 = 1MB/s）

::: tip 限速说明
这是单个上传任务的限速，不是全局限速。
:::

### 稿件检查

#### 检查间隔

用于自动评论和审核检查的间隔时间（秒）：

::: warning 避免风控
不要设置过短的间隔，可能触发风控。
:::

#### 投稿最短间隔

两次投稿之间的最短间隔时间（秒），默认 0。

用于避免频繁投稿触发风控。

### 高级选项

#### 账号授权自动更新

自动刷新B站账号的授权Token，避免过期。

::: tip 推荐开启
开启后可以避免上传时因授权过期而失败。
:::

#### 使用必剪API

使用必剪的投稿接口而非Web接口。

::: tip 用途
可以解决部分风控问题，但编辑稿件仍使用Web接口。
:::

#### 上传分P持久化

将已上传的视频分P信息缓存到本地。

::: tip 优点
如果投稿失败，可以直接复用视频ID，避免重新上传。
:::

### 最大任务数

在"设置" -> "任务"中设置"B站上传最大任务数"。

控制同时运行的上传任务数量（不是分片并发）。

::: warning 注意

1. 手动暂停的任务不会被自动启动
2. 这里的任务数指的是同时上传的视频数，不是分片并发数

:::

## 续传功能

支持对已存在的稿件添加新的分P。

::: warning 注意

- 续传不会修改原有稿件信息
- 新分P会添加到最后

:::

## 上传任务管理

### 任务操作

#### 暂停/继续

上传任务分为三个阶段，只有第二阶段支持暂停：

1. **获取上传基础信息**（不可暂停）
2. **文件切片上传**（可暂停/继续）
3. **文件合并，调用提交接口**（不可暂停、不可取消）

::: tip 暂停说明
处于第一和第三阶段时，点击暂停可能无效。
:::

#### 取消

取消上传任务。

::: warning 注意
进入第三阶段后无法取消。
:::

## 常见问题

### 上传提示输入验证码

说明上传过多触发风控：

1. 访问 [B站投稿页面](https://member.bilibili.com/platform/upload/video/frame) 手动投稿，解除风控
2. 减少上传频率
3. 增加"投稿最短间隔"
4. 等待一段时间再尝试

### 频繁上传失败或上传速度慢

1. **检查是否被运营商限速**
2. **检查账号授权是否过期**
3. **升级到最新版本**
4. **增加重试次数和延迟**
5. **手动测试并选择上传线路**
   - 访问 [测速页面](https://member.bilibili.com/preupload?r=ping)
   - 选择延迟最低的线路
6. **尝试关闭IPv6**
7. **尝试修改DNS**
8. **国外服务器使用 `qn` 线路**
9. **降低并发数**
